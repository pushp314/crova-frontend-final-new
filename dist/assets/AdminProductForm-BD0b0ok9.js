import{c as I,u as E,r as i,a as m,z as u,j as e,X as q}from"./index-D7lwuD4-.js";import{A as D}from"./arrow-left-Yl0ryfsv.js";import{U as F}from"./upload-ER7VehMf.js";import{S as L}from"./save-Dw-do1PM.js";const O=()=>{const p=I(),{id:n}=E(),l=!!n,[g,d]=i.useState(!1),[b,y]=i.useState([]),[r,h]=i.useState({name:"",description:"",price:"",comparePrice:"",category:"",stock:"",isActive:!0}),[j,f]=i.useState([]),[v,x]=i.useState([]);i.useEffect(()=>{N(),l&&w()},[n]);const N=async()=>{try{const{data:a}=await m.get("/categories");a.success&&y(a.categories||[])}catch(a){console.error("Error fetching categories:",a)}},w=async()=>{try{d(!0);const{data:a}=await m.get(`/products/${n}`);if(a.success){const s=a.data.product;h({name:s.name,description:s.description||"",price:s.price,comparePrice:s.comparePrice||"",category:s.categoryId,stock:s.variants?.[0]?.stock||0,isActive:s.isActive}),s.images&&x(s.images.map(c=>c.imagePath))}}catch(a){console.error("Error fetching product:",a),u.error("Failed to fetch product details"),p("/admin/products")}finally{d(!1)}},o=a=>{const{name:s,value:c,type:t,checked:S}=a.target;h(A=>({...A,[s]:t==="checkbox"?S:c}))},k=a=>{const s=Array.from(a.target.files);f(t=>[...t,...s]);const c=s.map(t=>URL.createObjectURL(t));x(t=>[...t,...c])},P=a=>{f(s=>s.filter((c,t)=>t!==a)),x(s=>s.filter((c,t)=>t!==a))},C=async a=>{a.preventDefault(),d(!0);try{const s=new FormData;s.append("name",r.name),s.append("description",r.description),s.append("price",r.price),s.append("comparePrice",r.comparePrice),s.append("category",r.category),s.append("stock",r.stock),s.append("isActive",r.isActive),j.forEach(c=>{s.append("images",c)}),l?(await m.put(`/products/${n}`,s,{headers:{"Content-Type":"multipart/form-data"}}),u.success("Product updated successfully")):(await m.post("/products",s,{headers:{"Content-Type":"multipart/form-data"}}),u.success("Product created successfully")),p("/admin/products")}catch(s){console.error("Error saving product:",s),u.error(s.response?.data?.message||"Failed to save product")}finally{d(!1)}};return g&&l?e.jsx("div",{className:"p-12 text-center",children:"Loading..."}):e.jsxs("div",{className:"max-w-4xl mx-auto pb-20",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>p("/admin/products"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:l?"Edit Product":"Add New Product"})]}),e.jsxs("form",{onSubmit:C,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name"}),e.jsx("input",{required:!0,type:"text",name:"name",value:r.name,onChange:o,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{rows:"4",name:"description",value:r.description,onChange:o,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (₹)"}),e.jsx("input",{required:!0,type:"number",name:"price",value:r.price,onChange:o,min:"0",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Compare at Price (₹)"}),e.jsx("input",{type:"number",name:"comparePrice",value:r.comparePrice,onChange:o,min:"0",placeholder:"Optional",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Set higher than price to show discount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{required:!0,name:"category",value:r.category,onChange:o,className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-black",children:[e.jsx("option",{value:"",children:"Select Category"}),b.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Initial Stock"}),e.jsx("input",{required:!0,type:"number",name:"stock",value:r.stock,onChange:o,min:"0",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Stock for base variant"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer gap-3",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:r.isActive,onChange:o,className:"w-5 h-5 text-black border-gray-300 rounded focus:ring-black"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Active (Visible in store)"})]})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Images"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[v.map((a,s)=>e.jsxs("div",{className:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden border border-gray-200",children:[e.jsx("img",{src:a,alt:`Preview ${s}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>P(s),className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow hover:bg-red-50 text-red-600",children:e.jsx(q,{className:"w-4 h-4"})})]},s)),e.jsxs("label",{className:"aspect-square bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx(F,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Upload Image"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:k,className:"hidden"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 bg-black text-white px-8 py-3 rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:[e.jsx(L,{className:"w-5 h-5"}),g?"Saving...":"Save Product"]})})]})]})};export{O as default};
